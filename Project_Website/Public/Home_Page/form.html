<!DOCTYPE html>
<html lang="en">
<!-- Form to key in additional user details and store in database. -->

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
  <title>Additional Details</title>

  <!-- File in /form/style.css -->
  <link rel="stylesheet" href="comp-form-style.css" type="text/css" />

  <!-- Firebase setup. -->
  <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.1.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/5.3.0/firebase-storage.js"></script>
  <!-- jQuery-->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
  <style media="screen">
    body {
      display: flex;
      min-height: 100vh;
      width: 100%;
      padding:0;
      margin:0;
      align-items: center;
      justify-content: : center;
      flex-direction: column;
    }
    #uploader{
      -webkit-appearance: none;
      appearance: none;
      width: 50%;
      margin-bottom: 10px
    }
  </style>
</head>
<!-- onload document function to determine which form to load. See function for more details. -->

<body>
  <progress value="0" max="100" id="uploader">0%</progress>
  <input type="file" value="upload" id="fileButton"/>

  <script>
    // Initialize Firebase
    var config = {
      apiKey: "AIzaSyDqlaeDVox13ySVHHh0ukCyZepg7QyD0B4",
      authDomain: "sgcomps-b8fdc.firebaseapp.com",
      databaseURL: "https://sgcomps-b8fdc.firebaseio.com",
      projectId: "sgcomps-b8fdc",
      storageBucket: "sgcomps-b8fdc.appspot.com",
      messagingSenderId: "1048240965389"
    };
    firebase.initializeApp(config);

    var uploader = document.getElementById("uploader");
    var fileButton = document.getElementById("fileButton");

    fileButton.addEventListener("change", function(e){
      var file = e.target.files[0];
      console.log(file)
      var storageRef = firebase.storage().ref("images/" +file.name);

      var task = storageRef.put(file);

      task.on("state_changed",
        function progress(snapshot){
          var percentage = (snapshot.bytesTransferred/snapshot.totalBytes)*100;
          uploader.value = percentage;
        },
        function error(err){

        },
        function complete(){

        });
    });
  </script>
</body>
</html>
